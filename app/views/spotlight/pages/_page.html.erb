<% page = f.object %>
<li class="dd-item dd3-item" data-id="<%= page.id %>">
  <div class="dd-handle dd3-handle">Drag</div>
  <div class="dd3-content panel panel-default">
    <div class="panel-heading page">
      <a class="pull-right btn btn-text" data-toggle="collapse" href="#collapse-page-<%= page.id %>"><%= t(:'spotlight.feature_pages.options') %>
        <span class="glyphicon glyphicon-chevron-right"></span>
      </a>
      <%= f.check_box :published, label: '' %>
      <div class="main">
        <h3 class="panel-title"><%= page.title %></h3>
        <div class="page-links">
          <%= link_to t('helpers.submit.view'), [spotlight, page.exhibit, page], :class => 'btn btn-text' %> &middot;
          <%= link_to t('helpers.submit.edit'), [spotlight, :edit, page.exhibit, page], :class => 'btn btn-text' %> &middot;
          <%= link_to t('helpers.submit.destroy'), [spotlight, page.exhibit, page], method: :delete, data: { confirm: t('helpers.submit.destroy_are_you_sure') }, :class => 'btn btn-text' %>
        </div>
      </div>
    </div>
    <div id="collapse-page-<%= page.id %>" class="panel-collapse collapse">
      <div class="panel-body">
        <%= f.text_field :title, label: t('spotlight.administration.page_title') %>
        <%= f.hidden_field :id %>
        <%= f.hidden_field :weight, data: {property: "weight"} %>
        <!--<input type="hidden" id="page_<%= page.id %>_weight" name="pages[<%= page_model %>][<%= page.id %>][weight]" value="<%= page.weight %>" />-->
        <%- if page.feature_page? -%>
          <div class="col-sm-offset-2 col-sm-10">
            <%= f.hidden_field :parent_page_id, data: {property: "parent_page"} %>
            <%= f.check_box :display_sidebar, label: t('spotlight.administration.show_sidebar') %>
          </div>
        <%- end -%>
      </div>
    </div>
  </div>
  <%- unless page.child_pages.blank? -%>
    <ol class="dd-list">
      <%- page.child_pages.each do |child_page| -%>
        <%= parent_form.fields_for page_model.pluralize.to_sym, child_page do |p| %>
          <%= render partial: 'page', locals: {f: p, parent_form: parent_form} %>
        <%- end -%>
      <%- end -%>
    </ol>
  <%- end -%>
</li>
