<%= render 'spotlight/shared/curation_sidebar' %>
<div id="content" class="col-md-9">
  <% @page_title = t(:'spotlight.administration.users.title') %>

  <h1><%= t :'spotlight.administration.header' %></h1>
  <h2 class="text-muted"><%= t :'spotlight.administration.users.header' %></h2>
  <%= bootstrap_form_for @exhibit, url: spotlight.update_all_exhibit_roles_path(@exhibit) do |f| %>

    <table class="table table-striped">
      <thead>
        <th>Name</th>
        <th>Role</th>
        <th>Actions</th>
      </thead>
      <tbody>
      <%= f.fields_for :roles do |r| %>
        <tr data-show-for="<%= r.object.id %>">
          <td><%= r.object.user.to_s %></td>
          <td><%= r.object.role.humanize %></td>
          <td><%= link_to "Edit", data: {behavior: 'edit-user', target: r.object.id } do %>
            <span class="glyphicon glyphicon-edit"></span>
          <% end %></td>
        </tr>
        <tr data-edit-for="<%= r.object.id %>">
          <td><%= r.text_field :user_key, hide_label: true %></td>
          <td><%= r.select :role, {'Admin'=>'admin', 'Curator'=>'curator'}, {}, {hide_label: true} %></td>
          <td></td>
        </tr>
        <tr data-edit-for="<%= r.object.id %>">
          <td><%= f.submit t(:'spotlight.administration.users.remove'), class: 'btn btn-danger', data: { behavior: 'destroy-user', target: r.object.id} %>
          <%= r.hidden_field :_destroy, data: {'destroy-for' => r.object.id} %>
          </td>
          <td colspan=2>
            <%= button_tag t(:'spotlight.administration.users.cancel'), class: 'btn btn-text', data: {behavior: 'cancel-edit' } %>
            <%=f.submit t(:'spotlight.administration.users.update'), class: 'btn btn-primary'%>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  <% end %>
</div>
